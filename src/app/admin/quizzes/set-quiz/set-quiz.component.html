<div *ngIf="!loading">
    <div class="adminPageTop">
        <div class="row">
            <div class="col-lg-10">
                <h1>
                    <fa-icon [icon]="faEdit"></fa-icon>
                    Quiz: {{ quiz.title_EN }}
                </h1>
            </div>
            <div class="col-lg-2">
                <mat-slide-toggle [color]="colorAccent" [checked]="quiz.isPublished" id="isPublished" name="isPublished"
                    class="mt-1" [disabled]="publishing || quiz.deletedAt" (change)="onPublish()">
                    {{ publishing ? 'Working...' : ( quiz.isPublished ? 'Published' : 'Publish' )  }}
                </mat-slide-toggle>
            </div>
        </div>

        <div style="display: flex; justify-content: space-between;">
            <p class="text-muted small">
                <em><strong>Created By: </strong> {{ quiz.createdBy }} - {{ quiz.createdAt | date:'medium' }}</em>
                <br>
                <em><strong>Updated By: </strong> {{ quiz.updatedBy }} - {{ quiz.updatedAt | date:'medium' }}</em>
            </p>
            <p class="text-muted small">
                <em *ngIf="quiz.isPublished"><strong>Published At: </strong>
                    {{ quiz.publishDateTime | date:'medium' }}
                </em>
            </p>
        </div>
        <hr>
    </div>

    <div class="adminPageBottom">
        <div class="row">
            <div class="col-lg-4 mb-3">
                <div class="mat-elevation-z4">
                    <img [src]="getSanitizedImage(quiz.imagePath)" alt="no preview" width="100%" height="150">
                </div>
            </div>
            <div class="col-lg-4 mb-3">
                <div class="desc mat-elevation-z4">
                    <strong>Description:</strong>
                    <div [innerHTML]="getSanitizedHtml(quiz.description_EN)"></div>
                </div>
            </div>
            <div class="col-lg-4 mb-3">
                <div class="info mat-elevation-z4" style="position: relative;">
                    <p>
                        <strong>Languages:</strong>
                        {{ quiz.languages }}
                    </p>
                    <p>
                        <strong>Duration:</strong>
                        {{ quiz.duration }} mins.
                    </p>
                    <a [routerLink]="['/admin', 'quizzes']" class="btn btn-danger btn-sm "
                        style="position: absolute; bottom:10px; right:5px;">
                        Close
                    </a>
                </div>
            </div>
        </div>

        <hr>

        <div class="row mb-5">
            <div class="col-lg-12">
                <div class="row mb-2">
                    <div class="col-lg-12">
                        <h2>
                            <fa-icon [icon]="faQuestionCircle"></fa-icon>
                            Questions:
                        </h2>
                        <div *ngIf="errors">
                            <div class="alert alert-danger" *ngFor="let error of errors">
                                {{ error }}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-4">
                        <button mat-raised-button color="primary" class="btn-block mb-3" (click)="onAddQuestion()">
                            <fa-icon [icon]="faPlusCircle"></fa-icon>
                            Create
                        </button>
                        <mat-expansion-panel class="exp-panel" [expanded]="allExpandState">
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    <strong> Questions</strong>
                                </mat-panel-title>
                                <mat-panel-description>
                                    <span class="small">{{ quiz.questions.length }} questions</span>
                                </mat-panel-description>
                            </mat-expansion-panel-header>

                            <ul class="list-group">
                                <li routerLinkActive="active" class="list-group-item full-width"
                                    *ngFor="let question of quiz.questions; let i = index;">
                                    <a [routerLink]="['question', question.id, question.slug_EN]">
                                        <!-- {{ i + 1 }} - {{ question.text_EN }} -->
                                        <span [class.text-danger]="question.deletedAt"
                                            [innerHTML]="(i + 1) + '- ' + getPlainText(question.text_EN)"></span>
                                        <span class="small text-muted ml-2">({{question.duration}} mins.)</span>
                                    </a>
                                </li>
                            </ul>
                        </mat-expansion-panel>

                    </div>
                    <div class="col-lg-8">
                        <router-outlet></router-outlet>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>